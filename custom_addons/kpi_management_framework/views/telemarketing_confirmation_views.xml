<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Add search view to prevent errors -->
    <record id="view_telemarketing_confirmation_search" model="ir.ui.view">
        <field name="name">telemarketing.confirmation.search</field>
        <field name="model">telemarketing.confirmation</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" string="Confirmation Name"/>
                <field name="lead_id" string="Lead"/>
                <field name="telemarketer_id" string="Sales Representative"/>
                <field name="confirmation_date" string="Confirmation Date"/>
                <filter string="High Score" name="high_score" domain="[('overall_score', '>=', 80)]"/>
                <filter string="Today's Confirmations" name="today" domain="[('confirmation_date', '>=', context_today().strftime('%Y-%m-%d'))]"/>
                <group expand="0" string="Group By">
                    <filter string="Sales Representative" name="group_telemarketer" context="{'group_by': 'telemarketer_id'}"/>
                    <filter string="Confirmation Date" name="group_date" context="{'group_by': 'confirmation_date'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="view_telemarketing_confirmation_form" model="ir.ui.view">
        <field name="name">telemarketing.confirmation.form</field>
        <field name="model">telemarketing.confirmation</field>
        <field name="arch" type="xml">
            <form string="Telemarketing Confirmation" create="false" edit="false">
                <header>
                    <button name="action_confirm_all" string="Confirm All" type="object" class="btn-primary"/>
                </header>
                <sheet>
                    <group>
                        <group string="Basic Information">
                            <field name="name"
                                   readonly="[('id', '!=', False)]"
                                   string="Confirmation ID"
                                   help="Auto-generated unique confirmation number. Only system administrators can edit this field."/>

                            <field name="lead_id" required="1"/>
                            <field name="telemarketer_id" required="1" readonly="1"
                                   string="Sales Representative"
                                   invisible="[('lead_id', '=', False)]"
                                   help="Automatically set to the user who originally created the lead"/>
                            <field name="confirmation_date"/>
                        </group>
                        <group string="Data Quality Confirmations">
                            <field name="name_confirmed"/>
                            <field name="address_confirmed"/>
                            <field name="phone_confirmed"/>
                            <field name="service_satisfaction_confirmed"/>
                            <field name="product_information_confirmed"/>
                        </group>
                    </group>
                    <group string="Overall Score">
                        <field name="overall_score" widget="progressbar" options="{'edit': false}"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_telemarketing_confirmation_tree" model="ir.ui.view">
        <field name="name">telemarketing.confirmation.tree</field>
        <field name="model">telemarketing.confirmation</field>
        <field name="arch" type="xml">
            <tree string="KPI Target Lines" create="false">
                <field name="name"/>
                <field name="lead_id"/>
                <field name="telemarketer_id" string="Sales Representative"/>
                <field name="confirmation_date"/>
                <field name="overall_score" widget="progressbar"/>
                <field name="kpi_history_ids" widget="many2many_tags"/>
            </tree>
        </field>
    </record>

    <record id="action_telemarketing_confirmation" model="ir.actions.act_window">
        <field name="name">Telemarketing Confirmations</field>
        <field name="res_model">telemarketing.confirmation</field>
        <field name="view_mode">tree,form</field>
        <!-- Add search view reference -->
        <field name="search_view_id" ref="view_telemarketing_confirmation_search"/>
    </record>
</odoo>